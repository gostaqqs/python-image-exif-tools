import os
import datetime
from exif import Image

def modify_date_taken(folder_path, delta_hours=-12):
    for root, dirs, files in os.walk(folder_path):
        for file in files:
            if file.lower().endswith(('.jpg', '.jpeg')):
                file_path = os.path.join(root, file)
                try:
                    with open(file_path, 'rb') as image_file:
                        img = Image(image_file)

                    if not img.has_exif:
                        print(f"Skipping file {file_path}: No EXIF data")
                        continue

                    if img.datetime_original:
                        date_format = "%Y:%m:%d %H:%M:%S"
                        date_taken = datetime.datetime.strptime(img.datetime_original, date_format)

                        # Subtract 12 hours
                        date_taken -= datetime.timedelta(hours=delta_hours)

                        # Update the EXIF data
                        img.datetime_original = date_taken.strftime(date_format)

                        with open(file_path, 'wb') as image_file:
                            image_file.write(img.get_file())

                except Exception as e:
                    print(f"Error processing file {file_path}: {e}")

# Replace 'folder_path' with the path of the folder containing the image files
folder_path = "I:\KOBALT_drive_01\Images"
modify_date_taken(folder_path)
